<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="https://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

  <title>
    
      Introduction to ARIMA Model &middot; COEP DSAI
    
  </title>

  


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon.png" />
<link rel="shortcut icon" href="/favicon.ico" />

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />

  <!-- Additional head bits without overriding original head -->
<!-- Include MathJax support -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      CommonHTML: {linebreaks: { automatic: true}},
      SVG: {linebreaks: { automatic: true}},
      "HTML-CSS": {linebreaks: { automatic: true}}
    });
    MathJax.Hub.Register.StartupHook("CommonHTML multiline Ready",function () {
      var PENALTY = MathJax.ElementJax.mml.mbase.prototype.CHTMLlinebreakPenalty;
      PENALTY.toobig = 1000000;
    });
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
</head>


  <body class="post">

    <div id="sidebar">
  <header>
    <div class="site-title">
      <a href="/">
        
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        
        COEP DSAI
      </a>
    </div>
    <p class="lead">Data Science and Artificial Intelligence Club at College of Engineering, Pune</p>
  </header>
  <nav id="sidebar-nav-links">
  
    <a class="home-link "
        href="/">Home</a>
  
  

  

  


  
    
      <a class="page-link "
          href="/about.html">About</a>
    
  

  
    
  

  

  
    
  

  
    
  

  

  
    
  


  


  
    
  

  
    
  

  

  
    
  

  
    
  

  

  
    
  


  <!-- Optional additional links to insert in sidebar nav -->
</nav>


  

  <nav id="sidebar-icon-links">
  

  <a id="subscribe-link"
     class="icon" title="Subscribe" aria-label="Subscribe"
     href="/feed.xml">
    <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <circle cx="6.18" cy="17.82" r="2.18"/>
    <path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/>
</svg>
  </a>

  
  
  
  

  
    <a id="tags-link"
       class="icon"
       title="Tags" aria-label="Tags"
       href="/tags.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
    </a>
  

  
    <a id="search-link"
       class="icon"
       title="Search" aria-label="Search"
       href="/search.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>
    </a>
  

  <!-- Optional additional links to insert for icons links -->
</nav>

  <p>
  &copy; 2020.
  <a href="/LICENSE.md">MIT License.</a>
</p>

</div>

    <main class="container">
      <header>
  <h1 class="post-title">Introduction to ARIMA Model</h1>
</header>
<div class="content">
  <div class="post-meta">
  <span class="post-date">15 May 2020</span>
  <span class="post-categories">
    
  </span>
</div>


  <div class="post-body">
    <p>Author: <a href="https://www.linkedin.com/in/jinit-sanghvi-4329a016b/">Jinit Sanghvi</a></p>

<h1 id="introduction-to-arimamodel">Introduction to ARIMA Model</h1>

<h2 id="a-brief-introduction-followed-by-implementation">A brief introduction followed by implementation</h2>
<center>
<img src="https://www.freestockcharts.com/help/Content/Resources/Images/timeseriesforecast.png" />
</center>
<p style="text-align:center;">Taken from <a href="https://www.freestockcharts.com/">freestockcharts.com</a></p>

<p>ARIMA or Autoregressive Integrated Moving Average is a purely-regressive model and this model is used for forecasting values of a time series. A time series is essentially a sequence of data points or observations taken at different instances. Time Series are very common to find given how time-dependent most of the worldly schemes and variables are. To better understand this, take a look at the Stock Market or weather reports gathered over a timeline and you’ll observe patterns which are highly time-dependent.
<br />
In this post, we’ll first cover the theory and then move on to the code</p>

<h3 id="theory">Theory</h3>

<p>One of the best ways to be introduced to the model is to understand why we’re using it, especially when other effective regression models like linear regression or multivariate regression exists. For time-series forecasting, why do we prefer the ARIMA model? Most of the time-series data available online focuses on the dependent variable, and how the dependent variable changes with time. For models like linear regression, we need independent variables to map a function from dependent variables to dependent variables for prediction.
However, this is not always possible because:-
<br /></p>
<ol>
    <li>Independent Variables are not always available.</li>
        <li>In quite a few scenarios, too many independent variables exist and we may find it difficult to find enough dependent variables to sufficiently explain the behavior of the time-series.</li>
</ol>
<p><i>On the other hand, ARIMA leverages the correlation between the values of the time-series and time, allowing it to better understand the relation between independent variables and time. Since the model focuses more on patterns and behavior of the time-series instead of finding out which factors affect these dependent variables, the model is able to forecast on the basis of these recognized patterns and behavior.</i></p>
<hr />

<p><i>To better understand this model, let’s break it down into 2 parts and then integrate those 2 parts in the end.</i></p>

<h2 id="ar-or-autoregressive-model">AR or Autoregressive Model</h2>

<p>The intuition behind this model is that observations at different time-steps are related to the previous value of the variable. For example, on a hot sunny day, you predict that the next day will be hotter because you’ve noticed increasing temperatures. Similarly, the AR model finds the correlation between future time-steps and past time-steps to forecast future values.</p>

<script type="math/tex; mode=display">Y_t  = \alpha + \beta_1Y_{t-1} + \beta_2Y_{t-2} + \dots + \beta_pY_{t-p} + \epsilon_1</script>

<!--![AR Equation](https://latex.codecogs.com/gif.latex?Y_t%20%3D%20%5Calpha%20&plus;%20%5Cbeta_1*Y_t_-_1%20&plus;%20%5Cbeta_2*Y_t_-_2%20..%20&plus;%20%5Cbeta_p*Y_t_-_p%20&plus;%20%5Cepsilon_1)-->
<p><em>By the above equation, we can see how we can reduce this to a regression problem and statistically find the correlation between future values and earlier time-steps.</em></p>

<hr />

<h2 id="moving-average-model">Moving Average Model</h2>

<p>The intuition behind this model in nature is of reinforcement, i.e, a moving average model tries to learn from the previous errors it has committed and tries to tweak itself accordingly. To better understand this, take a look at the equation below:</p>

<script type="math/tex; mode=display">Y_t = \alpha + \epsilon_t + \phi_1\epsilon_{t - 1} + \phi_2\epsilon_{t-2} + \dots + \phi_q\epsilon_{t-q}</script>

<p><small>But, what does <script type="math/tex">\epsilon</script> signify? Simply put, it is the error or the difference between the actual value and the predicted value.</small>
<br /></p>

<p><i>Since this model tries to learn from its mistakes, it is better able to account for unpredictable changes in value and is able to correct itself to provide more accurate results and predictions.</i></p>
<hr />

<p>Now that you’ve understood the Autoregressive Model and the Moving Averages model, it’s time to learn about ARIMA. When the Autoregressive Terms and the Moving Average terms are combined together with differencing to make the time-series stationary(more on this later), we get the ARIMA Model! Since the equation is regressive in nature, we can find the respective weights of the terms in the equation using regression techniques.</p>

<p><script type="math/tex">Y_t = \alpha + \beta_1Y_{t-1} + \beta_2Y_{t-2} + \dots + \beta_pY_{t-p} + \phi_1\epsilon_{t - 1} + \phi_2\epsilon_{t-2} + \dots + \phi_q\epsilon_{t-q}</script>
<!--![ARIMA Equation](https://latex.codecogs.com/gif.latex?Y_t%20%3D%20%5Calpha%20&plus;%20%5Cbeta%20_1Y_t_-_1%20&plus;%20%5Cbeta%20_2Y_t_-_2%20&plus;%20....%20&plus;%20%5Cbeta%20_pY_t_-_p%20&plus;%20%5Cphi%20_1%5Cepsilon_t_-_1%20&plus;%20%5Cphi%20_2%5Cepsilon_t_-_2%20&plus;%20....%20&plus;%20%5Cphi%20_q%5Cepsilon_t_-_q)--></p>

<hr />

<blockquote>
  <p>So far, we’ve understood the basic intuition behind the ARIMA Model. Let’s dig a bit deeper and understand the parameters of an ARIMA model.</p>
</blockquote>

<blockquote>
  <p>Consider a list below, and assume that every successive element of the list is a successive time-step or observation.</p>
</blockquote>

<script type="math/tex; mode=display">[1, 3, 5, 4]</script>

<blockquote>
  <p>Now, when we difference the list, we subtract the nth value of the series with the (n-1)th value of the series. For a better understanding:</p>
</blockquote>

<blockquote>
  <p>After First Differencing:</p>
</blockquote>

<script type="math/tex; mode=display">[3–1, 5–3, 4–5] = [2, 2, -1]</script>

<blockquote>
  <p>After Second Differencing:</p>
</blockquote>

<script type="math/tex; mode=display">[2–2, -1–2] = [0, -3]</script>

<p>The reason why we difference the time-series is to make the time-series stationary, i.e, the mean and the variance of the time-series remains constant/stable over time which allows us to reduce components like trend and seasonality(illustrated later). This is important because ARIMA expects the time-series to be stationary. Thus, we keep differencing the time-series till it becomes stationary.</p>

<p><i>Now that we have understood all the underlying concepts that we’re going to utilize, let’s learn how to find these parameters and dive right into the code!</i></p>

<blockquote>
  <p>To begin with, let’s start with some basic imports.</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="n">sm</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'axes.labelsize'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'xtick.labelsize'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'ytick.labelsize'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'text.color'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'k'</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.arima_model</span> <span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</code></pre></div></div>

<p>For this post, I’m going to use a time-series from the <em>Huge Stock Market Dataset</em>. This is just a sample time-series used to further ground the concepts you read about. At the end of this post, you’ll be able to apply these concepts to any other time-series you want to.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">aus1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"a.us.txt"</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">','</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> 
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">aus1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
  <style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

  <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>OpenInt</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1999-11-18</th>
      <td>30.713</td>
      <td>33.754</td>
      <td>27.002</td>
      <td>29.702</td>
      <td>66277506</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1999-11-19</th>
      <td>28.986</td>
      <td>29.027</td>
      <td>26.872</td>
      <td>27.257</td>
      <td>16142920</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1999-11-22</th>
      <td>27.886</td>
      <td>29.702</td>
      <td>27.044</td>
      <td>29.702</td>
      <td>6970266</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1999-11-23</th>
      <td>28.688</td>
      <td>29.446</td>
      <td>27.002</td>
      <td>27.002</td>
      <td>6332082</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1999-11-24</th>
      <td>27.083</td>
      <td>28.309</td>
      <td>27.002</td>
      <td>27.717</td>
      <td>5132147</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">aus1</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div></div>

<div>
  <style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

  <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Volume</th>
      <th>OpenInt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>4521.000000</td>
      <td>4521.000000</td>
      <td>4521.000000</td>
      <td>4521.000000</td>
      <td>4.521000e+03</td>
      <td>4521.0</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>27.856296</td>
      <td>28.270442</td>
      <td>27.452486</td>
      <td>27.871357</td>
      <td>3.993503e+06</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>std</th>
      <td>12.940880</td>
      <td>13.176000</td>
      <td>12.711735</td>
      <td>12.944389</td>
      <td>2.665730e+06</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>min</th>
      <td>7.223100</td>
      <td>7.513900</td>
      <td>7.087800</td>
      <td>7.323800</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>19.117000</td>
      <td>19.435000</td>
      <td>18.780000</td>
      <td>19.089000</td>
      <td>2.407862e+06</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>24.456000</td>
      <td>24.809000</td>
      <td>24.159000</td>
      <td>24.490000</td>
      <td>3.460621e+06</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>36.502000</td>
      <td>37.046000</td>
      <td>35.877000</td>
      <td>36.521000</td>
      <td>4.849809e+06</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>max</th>
      <td>105.300000</td>
      <td>109.370000</td>
      <td>97.881000</td>
      <td>107.320000</td>
      <td>6.627751e+07</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">aus1</span><span class="o">.</span><span class="n">index</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DatetimeIndex(['1999-11-18', '1999-11-19', '1999-11-22', '1999-11-23',
               '1999-11-24', '1999-11-26', '1999-11-29', '1999-11-30',
               '1999-12-01', '1999-12-02',
               ...
               '2017-10-30', '2017-10-31', '2017-11-01', '2017-11-02',
               '2017-11-03', '2017-11-06', '2017-11-07', '2017-11-08',
               '2017-11-09', '2017-11-10'],
              dtype='datetime64[ns]', name='Date', length=4521, freq=None)
</code></pre></div></div>

<blockquote>
  <p>Before we use this time-series, we first need to resample it into a time-series wherein each observation differs by a month.</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y1</span> <span class="o">=</span> <span class="n">aus1</span><span class="p">[</span><span class="s">'Open'</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s">'MS'</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">aus1</span><span class="p">[</span><span class="s">'Close'</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s">'MS'</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">y1</span><span class="o">.</span><span class="n">index</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DatetimeIndex(['1999-11-01', '1999-12-01', '2000-01-01', '2000-02-01',
               '2000-03-01', '2000-04-01', '2000-05-01', '2000-06-01',
               '2000-07-01', '2000-08-01',
               ...
               '2017-02-01', '2017-03-01', '2017-04-01', '2017-05-01',
               '2017-06-01', '2017-07-01', '2017-08-01', '2017-09-01',
               '2017-10-01', '2017-11-01'],
              dtype='datetime64[ns]', name='Date', length=217, freq='MS')
</code></pre></div></div>

<blockquote>
  <p>So far, so good! Let’s plot the time-series and see what it looks like!</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/notebooks/2020-05-15-arima-code_files/2020-05-15-arima-code_10_0.png" alt="png" /></p>

<blockquote>
  <p>Now that we’ve seen what it looks like, let’s try breaking it down into its components. Let’s try extracting the trend, the seasonality and the residual of our time-series.</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s">'figure.figsize'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">8</span>
<span class="n">decomposition</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s">'additive'</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/notebooks/2020-05-15-arima-code_files/2020-05-15-arima-code_12_0.png" alt="png" /></p>

<p><em>Our inference from breaking the time-series down into components like seasonality and trend is that the given time-series is not stationary. Since the trend and seasonality of the time-series affect its values at different time-steps, this time-series is not stationary as its mean and variance keeps changing. Thus, we have to difference the time-series at least once to make it stationary.</em></p>

<p>If you remember, we discussed the three parameters of the ARIMA Model. In order to determine these 3 parameters and finding the best combination of these 3 parameters in order to yield the best results, we’ll use a combination of statistical tools and iteration (trying out different models to check which achieves the best results). </p>

<p>Let’s start by determining <script type="math/tex">d</script>. As we mentioned earlier, we’ll keep differencing the time-series until it becomes stationary. Let’s try differencing it once and use the Augmented Dickey Fuller Test to find if it is stationary or not.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">log</span>
<span class="n">y1_d</span> <span class="o">=</span> <span class="n">y1</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="n">y1_d</span> <span class="o">=</span> <span class="n">y1_d</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">y1_d</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'ADF Statistic: </span><span class="si">%</span><span class="s">f'</span> <span class="o">%</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s">'p-value: </span><span class="si">%</span><span class="s">f'</span> <span class="o">%</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ADF Statistic: -2.955284
p-value: 0.039287
</code></pre></div></div>

<p><em>As we see that the <script type="math/tex">p</script>-value obtained is less than 0.05, we can reject the null hypothesis and say that the series is stationary. We can also see that the series has become more stationary from the plot above. Thus, obtaining a <script type="math/tex">p</script>-value of less than 0.05 using ADF is a good indicator that our time-series has become stationary.</em></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y1_d</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/notebooks/2020-05-15-arima-code_files/2020-05-15-arima-code_18_0.png" alt="png" /></p>

<p>In order to determine <script type="math/tex">p</script>, we need to first understand what an ACF plot is. Autocorrelation Function plot or ACF plot shows how correlated the variable is with its previous time-steps. For example, while predicting stock prices, the ACF plot tries to show how correlated the stock prices of March are to the stock prices of February, how likely are the stock prices in March to follow the behavior of stock prices in February. To better understand this, let’s plot it.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span><span class="n">plot_pacf</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot_acf</span><span class="p">(</span><span class="n">y1_d</span><span class="p">,</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

</code></pre></div></div>

<p><img src="/assets/notebooks/2020-05-15-arima-code_files/2020-05-15-arima-code_21_0.png" alt="png" /></p>

<p><img src="/assets/notebooks/2020-05-15-arima-code_files/2020-05-15-arima-code_21_1.png" alt="png" /></p>

<p><small>We can see that the auto-correlation is strong for the first 2 lags and then it decays and oscillates in the blue region.</small></p>

<p><em>Inferring from this, we can see that the first 1–2 lags show high correlation and values keep decreasing in the blue region.</em><br />
Thus, we can say that the value of <script type="math/tex">p</script> will lie in the range spanning from 1 to 2.</p>
<hr />

<p>Let’s try determining <script type="math/tex">q</script> now. The process of determining <script type="math/tex">q</script> is very similar to the process of determining <script type="math/tex">p</script>. Instead of using ACF, we’ll now use a PACF, or a Partial Autocorrelation Function. A PACF plot shows how correlated a variable is with itself at a previous time-step, ignoring all linear dependencies it has on time-steps that lie between the time-step against which correlation is to be found and the current time-step. Also called a conditional correlation fucntion, PACF aims to find the correlation between two time-steps independent of all other time-steps in between. Let’s understand this better with a plot.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plot_pacf</span><span class="p">(</span><span class="n">y1_d</span><span class="p">,</span><span class="n">lags</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/assets/notebooks/2020-05-15-arima-code_files/2020-05-15-arima-code_25_0.png" alt="png" /></p>

<p><img src="/assets/notebooks/2020-05-15-arima-code_files/2020-05-15-arima-code_25_1.png" alt="png" /></p>

<p><em>From the plot we can see that the plot cuts off to zero at the second lag so we can estimate that the value of <script type="math/tex">q</script> will be lesser than 2.</em><br />
Thus, we can say that the value <script type="math/tex">q</script> shall lie in the range spanning from 0 to 1.</p>
<hr />

<blockquote>
  <p>You’ve finally learnt the necessary building blocks required to create an ARIMA model in order to perform time-series forecasting! Let’s jump right into it!</p>
</blockquote>

<p>We divide our time-frame into a training and a testing set so that we can later gauge how well our model is performing. Training data is 70% of the original time-series data and testing data is 30% of the original time-series data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.7</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">y1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">size</span><span class="p">],</span> <span class="n">y1</span><span class="p">[</span><span class="n">size</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">y1</span><span class="p">)]</span>
<span class="n">series</span> <span class="o">=</span> <span class="p">[</span><span class="n">y1</span> <span class="k">for</span> <span class="n">y1</span> <span class="ow">in</span> <span class="n">train</span><span class="p">]</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></div>

<blockquote>
  <p>Alright, now let’s start training the model! Let’s try using values of <script type="math/tex">(p,d,q)</script> equal to (2,1,1) and see how the model performs!</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)):</span>
    <span class="n">arima_model</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">model_fit</span> <span class="o">=</span> <span class="n">arima_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">()</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
    <span class="n">actual_val</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
    <span class="n">series</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">actual_val</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Test error is {}'</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span><span class="s">'r'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Test error is 3.273019781729989





[&lt;matplotlib.lines.Line2D at 0x1d39598f668&gt;]
</code></pre></div></div>

<p><img src="/assets/notebooks/2020-05-15-arima-code_files/2020-05-15-arima-code_31_2.png" alt="png" /></p>

<p><em>We can see that the model has learnt the nature and behavior of the time-series, and is performing pretty well on the test set!</em></p>

<blockquote>
  <p>Let’s try out new values of <script type="math/tex">(p,d,q)</script>. Let’s try out (1,1,1) this time and see if we obtain better results.</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.7</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">y1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">size</span><span class="p">],</span> <span class="n">y1</span><span class="p">[</span><span class="n">size</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">y1</span><span class="p">)]</span>
<span class="n">series</span> <span class="o">=</span> <span class="p">[</span><span class="n">y1</span> <span class="k">for</span> <span class="n">y1</span> <span class="ow">in</span> <span class="n">train</span><span class="p">]</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)):</span>
    <span class="n">arima_model</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> 
    <span class="n">model_fit</span> <span class="o">=</span> <span class="n">arima_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">()</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
    <span class="n">actual_val</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
    <span class="n">series</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">actual_val</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'Test error is {}'</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">error</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span><span class="s">'r'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Test error is 2.355571525013936





[&lt;matplotlib.lines.Line2D at 0x1d3959f32b0&gt;]
</code></pre></div></div>

<p><img src="/assets/notebooks/2020-05-15-arima-code_files/2020-05-15-arima-code_35_2.png" alt="png" /></p>

<blockquote>
  <p>Great, we have obtained better results by changing the parameters of the model! By using the statistical methods above and by trying out different values, you can achieve great results on various different time-series.</p>
</blockquote>

<p><strong>I hope you’re now acquainted with various concepts of Time-Series Forecasting and the ARIMA Model!</strong></p>

<p>You can get the jupyter notebook corresponding to this blog <a href="/assets/notebooks/2020-05-15-arima-code.ipynb">here</a></p>

    



<div class="post-tags">
  
</div>
  </div>

  
  <!--section class="comments">
    <h2>Comments</h2>
    
  <p>
    You are seeing this because your Disqus shortname is not properly set. To
    configure Disqus, you should edit your <code>_config.yml</code> to include
    either a <code>disqus.shortname</code> variable.
  </p>

  <p>
    If you do not wish to use Disqus, override the
    <code>comments.html</code> partial for this theme.
  </p>


  </section-->

  <section class="related">
  <h2>Related Posts</h2>
  <ul class="posts-list">
    
      <li>
        <h3>
          <a href="/2020/04/21/adversarial-reprogramming.html">
            Adversarial Reprogramming
            <small>21 Apr 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/04/06/object-detection-and-instance-segmentation-overview.html">
            Object Detection and Instance Segmentation: A Detailed Overview
            <small>06 Apr 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/03/03/ml-with-python.html">
            An Introduction to Machine Learning with Python
            <small>03 Mar 2020</small>
          </a>
        </h3>
      </li>
    
  </ul>
</section>

</div>

    </main>

    <!-- Optional footer content -->

  </body>
</html>
